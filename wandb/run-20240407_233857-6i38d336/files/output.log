Epoch 0:   0%|          | 0/998 [00:00<?, ?it/s] Before .cpu() - Predicted Spikes: 98, True Beats: 54
True Beats: 0, Predicted Beats: 1
Epoch 0:   0%|          | 1/998 [00:01<24:28,  0.68it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 35
True Beats: 0, Predicted Beats: 0
INFO:pytorch_lightning.callbacks.model_summary:
  | Name       | Type                     | Params
--------------------------------------------------------
0 | S1         | Sequential               | 6.4 K
1 | rsnn_block | LinearRecurrentContainer | 30.7 K
2 | S2         | Sequential               | 6.3 K
3 | output     | Sequential               | 41
--------------------------------------------------------
43.4 K    Trainable params
0         Non-trainable params
43.4 K    Total params
0.174     Total estimated model params size (MB)
/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
/Users/remi/Documents/PhD/SpikingExp/spikingjelly_beat_detection.py:111: MatplotlibDeprecationWarning: Support for FigureCanvases without a required_interactive_framework attribute was deprecated in Matplotlib 3.6 and will be removed two minor releases later.
  plt.figure(figsize=(10, 4))
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 0:   0%|          | 2/998 [00:01<14:04,  1.18it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 37
True Beats: 0, Predicted Beats: 0
Epoch 0:   3%|▎         | 26/998 [00:03<02:18,  7.02it/s, v_num=d336]






























Epoch 0: 100%|██████████| 998/998 [01:02<00:00, 15.87it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 1:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 116
True Beats: 0, Predicted Beats: 0
Epoch 1:   0%|          | 1/998 [00:00<07:19,  2.27it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 46
True Beats: 1, Predicted Beats: 0
Epoch 1:   0%|          | 2/998 [00:00<08:14,  2.01it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 70
True Beats: 0, Predicted Beats: 0




Epoch 1:  11%|█         | 110/998 [00:12<01:40,  8.84it/s, v_num=d336]
wandb: WARNING Step only supports monotonically increasing values, use define_metric to set a custom x axis. For details see: https://wandb.me/define-metric
wandb: WARNING (User provided step: 0 is less than current step: 21. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_21_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529602.682849}).
wandb: WARNING (User provided step: 1 is less than current step: 21. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_21_b949760b095855586615.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529603.244916}).























Epoch 1:  99%|█████████▉| 990/998 [00:58<00:00, 16.95it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 2:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 115
True Beats: 1, Predicted Beats: 0
Epoch 2:   0%|          | 1/998 [00:00<05:44,  2.89it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 59
True Beats: 0, Predicted Beats: 0
Epoch 2:   0%|          | 2/998 [00:00<05:07,  3.23it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 59
True Beats: 0, Predicted Beats: 0





Epoch 2:  18%|█▊        | 183/998 [00:11<00:50, 16.20it/s, v_num=d336]
wandb: WARNING (User provided step: 0 is less than current step: 41. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_41_9a4d7b4dcc5cf7772f69.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529661.44918}).
wandb: WARNING (User provided step: 1 is less than current step: 41. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_41_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529661.7232482}).

























Epoch 2:  98%|█████████▊| 979/998 [01:01<00:01, 15.89it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 3:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 40
True Beats: 1, Predicted Beats: 0
Epoch 3:   0%|          | 1/998 [00:00<04:50,  3.43it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 49
True Beats: 0, Predicted Beats: 0
Epoch 3:   0%|          | 2/998 [00:00<04:14,  3.91it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 49
True Beats: 0, Predicted Beats: 0




Epoch 3:  16%|█▋        | 164/998 [00:08<00:45, 18.26it/s, v_num=d336]
wandb: WARNING (User provided step: 0 is less than current step: 61. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_61_9a4d7b4dcc5cf7772f69.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529724.412643}).
wandb: WARNING (User provided step: 1 is less than current step: 61. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_61_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529724.629107}).






















Epoch 3:  99%|█████████▉| 990/998 [00:52<00:00, 18.73it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
wandb: WARNING (User provided step: 0 is less than current step: 81. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_81_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529777.798136}).
wandb: WARNING (User provided step: 1 is less than current step: 81. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_81_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529777.991468}).
Epoch 4:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 53
True Beats: 0, Predicted Beats: 0
Epoch 4:   0%|          | 1/998 [00:00<07:26,  2.23it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 61
True Beats: 0, Predicted Beats: 0
Epoch 4:   0%|          | 2/998 [00:00<05:22,  3.09it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 35
True Beats: 0, Predicted Beats: 0























Epoch 4:  97%|█████████▋| 968/998 [00:48<00:01, 20.07it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 5:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 58
True Beats: 0, Predicted Beats: 0
Epoch 5:   0%|          | 1/998 [00:00<04:24,  3.77it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 52
True Beats: 0, Predicted Beats: 0
Epoch 5:   0%|          | 2/998 [00:00<04:15,  3.90it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 76
True Beats: 0, Predicted Beats: 0




Epoch 5:  16%|█▌        | 158/998 [00:10<00:55, 15.02it/s, v_num=d336]
wandb: WARNING (User provided step: 0 is less than current step: 101. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_101_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529827.021992}).
wandb: WARNING (User provided step: 1 is less than current step: 101. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_101_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529827.270232}).





















Epoch 5:  99%|█████████▊| 984/998 [00:52<00:00, 18.60it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 6:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 39
True Beats: 0, Predicted Beats: 0
Epoch 6:   0%|          | 1/998 [00:00<04:53,  3.40it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 58
True Beats: 0, Predicted Beats: 0
Epoch 6:   0%|          | 2/998 [00:00<04:48,  3.46it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 50
True Beats: 0, Predicted Beats: 0

Epoch 6:   4%|▍         | 38/998 [00:03<01:28, 10.83it/s, v_num=d336]
wandb: WARNING (User provided step: 0 is less than current step: 121. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_121_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529880.4890082}).
wandb: WARNING (User provided step: 1 is less than current step: 121. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_121_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529880.765075}).



























Epoch 6:  97%|█████████▋| 964/998 [00:57<00:02, 16.71it/s, v_num=d336]

Epoch 6: 100%|█████████▉| 994/998 [00:59<00:00, 16.79it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 7:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 60
True Beats: 0, Predicted Beats: 0
Epoch 7:   0%|          | 1/998 [00:00<04:20,  3.83it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 64
True Beats: 0, Predicted Beats: 0
Epoch 7:   0%|          | 2/998 [00:00<04:10,  3.97it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 60
True Beats: 0, Predicted Beats: 0
Epoch 7:   3%|▎         | 28/998 [00:01<01:04, 14.97it/s, v_num=d336]
wandb: WARNING (User provided step: 0 is less than current step: 141. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_141_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529939.828334}).
wandb: WARNING (User provided step: 1 is less than current step: 141. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_141_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529940.06989}).
























Epoch 7: 100%|█████████▉| 996/998 [00:50<00:00, 19.72it/s, v_num=d336]
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
Epoch 8:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 31
True Beats: 0, Predicted Beats: 0
Epoch 8:   0%|          | 1/998 [00:00<04:01,  4.13it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 62
True Beats: 1, Predicted Beats: 0
Epoch 8:   0%|          | 2/998 [00:00<03:47,  4.39it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 60
True Beats: 0, Predicted Beats: 0





Epoch 8:  21%|██        | 207/998 [00:11<00:45, 17.53it/s, v_num=d336]
wandb: WARNING (User provided step: 0 is less than current step: 161. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_161_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712529990.413017}).
wandb: WARNING (User provided step: 1 is less than current step: 161. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_161_b949760b095855586615.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712529990.6282182}).






















Epoch 8:  98%|█████████▊| 978/998 [00:55<00:01, 17.55it/s, v_num=d336]
Epoch 9:   0%|          | 0/998 [00:00<?, ?it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 102
True Beats: 0, Predicted Beats: 0
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
WARNING:matplotlib.legend:No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
wandb: WARNING (User provided step: 0 is less than current step: 181. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_181_4d04d2b9250d041c260f.png'], 'captions': ['Beat Detection (Sample 0)']}, '_timestamp': 1712530048.0080252}).
wandb: WARNING (User provided step: 1 is less than current step: 181. Dropping entry: {'Beat Detection Plot': {'_type': 'images/separated', 'width': 1000, 'height': 400, 'format': 'png', 'count': 1, 'filenames': ['media/images/Beat Detection Plot_181_47a77e26c89d89ee8bee.png'], 'captions': ['Beat Detection (Sample 1)']}, '_timestamp': 1712530048.406133}).
Epoch 9:   0%|          | 1/998 [00:00<07:56,  2.09it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 46
True Beats: 0, Predicted Beats: 0
Epoch 9:   0%|          | 2/998 [00:00<07:00,  2.37it/s, v_num=d336]Before .cpu() - Predicted Spikes: 0, True Beats: 63
True Beats: 0, Predicted Beats: 0






Epoch 9:  22%|██▏       | 223/998 [00:14<00:50, 15.21it/s, v_num=d336]



















Epoch 9:  99%|█████████▉| 988/998 [00:52<00:00, 18.86it/s, v_num=d336]
INFO:pytorch_lightning.utilities.rank_zero:`Trainer.fit` stopped: `max_epochs=10` reached.
Traceback (most recent call last):
  File "/Users/remi/Documents/PhD/SpikingExp/spikingjelly_beat_detection.py", line 192, in <module>
    main()
  File "/Users/remi/Documents/PhD/SpikingExp/spikingjelly_beat_detection.py", line 189, in main
    trainer.test(model)
  File "/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 754, in test
    return call._call_and_handle_interrupt(
  File "/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 794, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 937, in _run
    _verify_loop_configurations(self)
  File "/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/configuration_validator.py", line 42, in _verify_loop_configurations
    __verify_eval_loop_configuration(model, "test")
  File "/Users/remi/Documents/PhD/NLP/SpikingExp/lib/python3.9/site-packages/pytorch_lightning/trainer/configuration_validator.py", line 110, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")

Epoch 9: 100%|██████████| 998/998 [00:52<00:00, 18.90it/s, v_num=d336]